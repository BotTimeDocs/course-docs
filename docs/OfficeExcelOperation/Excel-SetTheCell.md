在前一节课程中，我们学习了如何对Excel文件进行简单的读写和删除。现在，我们将学习一下如何对Excel中的单元格进行设置。

在此单元中，你将学习到：
- Excel获取单元格背景色
- Excel设置单元格背景色
- Excel合并单元格

现在，我们打开一个本地的Excel文件，对该文件的单元格进行设置，那么如何实现呢？

你可以按照以下操作进行：

## 打开Excel文件并获取单元格背景色
首先，我们需要打开一个Excel文件，然后获取文件中指定单元格背景色
1. 打开编辑器进入主界面，在工具栏的设计标签页下，点击“新建项目”
2. 输入项目名称，例如“Excel设置单元格”。
3. 打开变量面板，创建一个字符串（String）变量-Color，用于接收获取到的颜色值
4. 从组件窗口拖入一个“打开/新建”组件到设计窗口
5. 在“打开/新建”组件的属性窗口中，输入以下内容：
    - **文件路径**："./Excel设置单元格.xlsx"
    - **可视**：勾选
6. 从组件窗口拖入一个“获取单元格背景色”组件到“打开/新建”组件内部
7. 在“获取单元格背景色”组件的属性窗口中，输入以下内容：
    - **单元格**："A1"</br>要获取背景色的目标单元格地址
    - **工作表**："Sheet1"</br>要获取背景色的目标工作表
    - **颜色**：Color</br>将获取到的背景色色值存储到Color变量中

## 设置Excel文件中的单元格背景色
现在，已经获取A1单元格的背景色，那么如何去设置其他单元格的背景色呢
1. 从组件窗口拖入一个“设置单元格背景色”组件到“获取单元格背景色”下方
2. 在“设置单元格背景色”组件的属性窗口中，输入以下内容：
    - **单元格**："A2"</br>要设置背景色的目标单元格地址
    - **工作表**："Sheet1"</br>要设置背景色的目标工作表
    - **颜色**：Color</br>将之前获取到背景色应用到新的单元格

## 合并Excel文件的单元格并将单元格内容打印
在Excel文件中，A1和A2单元格中有内容，现在进行合并并打印
1. 打开变量面板，创建一个字符串（String）变量-Result，用于存储单元格合并后的数据
2. 从组件窗口拖入一个“合并单元格”组件到“设置单元格背景色”下方
3. 在“合并单元格”组件的属性窗口中，输入以下内容：
    - **工作表**："Sheet1"</br>要合并的目标工作表
    - **区域**："A1:A2"</br>要进行合并的目标单元格区域
    - **合并值**：Result</br>将合并后的数据保存在Result变量中
4. 从组件窗口拖入一个“写入日志”组件到“合并单元格”下方
5. 在“写入日志”组件的属性窗口中，输入以下内容：
    - **日志内容**："合并单元格后的内容："+Result</br>将合并单元格后的数据打印出来

最终，项目如下所示：

![Excel设置单元格示例](https://docimages.blob.core.chinacloudapi.cn/images/Lesson/OfficeExcel/Excel-setTheCell.PNG)

## 运行自动化项目
在工具栏的设计标签页下，点击“运行”，将会自动打开一个Excel文件，并进行相关操作。在日志窗口中，可以看到，合并单元格后的数据被打印出来。

![Excel设置单元格日志](https://docimages.blob.core.chinacloudapi.cn/images/Lesson/OfficeExcel/log-setTheCell.PNG)

## 如何在编辑器中使用示例
对于上述示例，你可以在编辑器的“流程市场”进行下载和使用。
1. 打开编辑器进入主界面，在工具栏的设计标签页下，点击“流程市场”
2. 在搜索栏中输入示例名称-Excel设置单元格，搜索到对应流程
3. 选中该流程，点击“下载”，打开“新建项目”窗口
4. 输入自定义项目名称或使用默认名称，点击“创建”，即可下载成功
5. 在工作目录中，找到对应的项目，双击打开就可使用

除此之外，你还可以从云扩市场网站下载该示例流程，点击[此处]()前往下载。
